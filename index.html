<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGA - Syst√®me de Gestion des Agents</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="theme-color" content="#2c3e50">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê SGA - Syst√®me de Gestion des Agents</h1>
            <h2>Version Compl√®te - Gestion Planning & Personnel</h2>
        </div>
        
        <h2 id="sub-title">Chargement du syst√®me...</h2>
        
        <div class="main-content" id="main-content">
            <!-- Le contenu dynamique sera ins√©r√© ici par JavaScript -->
            <div style="text-align: center; padding: 50px;">
                <div style="font-size: 2em; color: #3498db; margin-bottom: 20px;">üîê</div>
                <p>Veuillez patienter pendant le chargement du syst√®me...</p>
            </div>
        </div>
    </div>

    <!-- Overlay pour les popups -->
    <div id="overlay">
        <div class="popup-content" id="popup-content">
            <!-- Le contenu des popups sera ins√©r√© ici par JavaScript -->
        </div>
    </div>

    <!-- Scripts -->
    <script src="data.js"></script>
    <script src="app.js"></script>
    
    <script>
        // Enregistrement du Service Worker pour PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('Service Worker enregistr√©:', registration);
                        
                        // V√©rifier les mises √† jour
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            console.log('Nouveau Service Worker trouv√©:', newWorker);
                            
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    if (confirm('Une nouvelle version est disponible. Recharger ?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.error('Erreur Service Worker:', error);
                    });
            });
        }

        // Script d'initialisation minimal
        document.addEventListener('DOMContentLoaded', function() {
            console.log('SGA System initializing...');
            
            // V√©rifier que les donn√©es sont charg√©es
            const dataCheck = () => {
                if (typeof agentsData === 'undefined') {
                    window.agentsData = [];
                    console.log('‚ö†Ô∏è agentsData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof radiosData === 'undefined') {
                    window.radiosData = [];
                    console.log('‚ö†Ô∏è radiosData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof uniformsData === 'undefined') {
                    window.uniformsData = [];
                    console.log('‚ö†Ô∏è uniformsData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof warningsData === 'undefined') {
                    window.warningsData = [];
                    console.log('‚ö†Ô∏è warningsData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof panicCodesData === 'undefined') {
                    window.panicCodesData = [];
                    console.log('‚ö†Ô∏è panicCodesData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof holidaysData === 'undefined') {
                    window.holidaysData = [];
                    console.log('‚ö†Ô∏è holidaysData non trouv√©, initialisation avec tableau vide');
                }
                
                if (typeof leavesData === 'undefined') {
                    window.leavesData = [];
                    console.log('‚ö†Ô∏è leavesData non trouv√©, initialisation avec tableau vide');
                }
                
                console.log('‚úÖ Donn√©es initialis√©es');
            };
            
            // Attendre que les scripts soient charg√©s
            setTimeout(dataCheck, 100);
        });
    </script>
</body>
</html>
